# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp
#rootpw  --iscrypted $6$AGkP8JeD2kANvyZE$KtuuBIqQdUFGLx7cJhrE6./q2erjyG26XKC6qU4M4ianrTrTF1LnKKs6ssK7yYrJ3yfGyHX79SxMKT.cYBSe..
rootpw  vagrant

user --name=vagrant --groups=wheel --password=vagrant
# Reboot after installation
reboot
firewall --disabled
authconfig --enableshadow --passalgo=sha512 --kickstart
selinux --permissive
timezone UTC
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"


# Format the partitions/mbr first
zerombr 
clearpart --all --initlabel

# Create primary partitions on first disk
part /boot --fstype "ext4" --size=512 --asprimary
part swap --fstype swap --size=4096

# Create logical partitions on disk sda
part pv.0 --size=1 --grow --ondisk=sda
volgroup rootVG pv.0
logvol /     --fstype ext4 --name=root --vgname=rootVG --size=2560 --grow
#logvol /tmp  --fstype ext4 --name=temp --vgname=rootVG --size=256 --fsoptions="nodev,noexec,nosuid"
#logvol /home --fstype ext4 --name=home --vgname=rootVG --size=1024 --fsoptions="nodev"
#logvol /var  --fstype ext4 --name=var  --vgname=rootVG --size=1024 --fsoptions="nodev"
#logvol /var/log --fstype ext4 --name=varlog --vgname=rootVG --size=512 --fsoptions="nodev,noexec,nosuid"
#logvol /var/log/audit --fstype ext4 --name=audit --vgname=rootVG --size=256 --fsoptions="nodev,noexec,nosuid"

# Create more logical partitions on disk sdb
#part pv.1 --size=1 --grow --ondisk=sdb
#volgroup dataVG pv.1
#logvol /var     --fstype ext4 --name=root --vgname=dataVG --size=2560 --grow


#repo --name="CentOS"  --baseurl=cdrom:sr0 --cost=100

%packages --excludedocs --nobase --ignoremissing
@Core
gcc
kernel-devel
kernel-headers
make
nfs-utils
openssh-clients
perl
sudo
wget
-aic94xx-firmware
-atmel-firmware
-b43-openfwwf
-bfa-firmware
-fprintd-pam
-intltool
-ipw2100-firmware
-ipw2200-firmware
-ivtv-firmware
-iwl100-firmware
-iwl1000-firmware
-iwl3945-firmware
-iwl4965-firmware
-iwl5000-firmware
-iwl5150-firmware
-iwl6000-firmware
-iwl6000g2a-firmware
-iwl6050-firmware
-libertas-usb8388-firmware
-ql2100-firmware
-ql2200-firmware
-ql23xx-firmware
-ql2400-firmware
-ql2500-firmware
-rt61pci-firmware
-rt73usb-firmware
-xorg-x11-drv-ati-firmware
-zd1211-firmware

%end

%post
# Force to set SELinux to a permissive mode
sed -i -e 's/\(^SELINUX=\).*$/\1permissive/' /etc/selinux/config
# sudo
echo "%vagrant ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers.d/vagrant
sed -i "s/^.*requiretty/#Defaults requiretty/" /etc/sudoers

/bin/mkdir /home/vagrant/.ssh
/bin/chmod 700 /home/vagrant/.ssh
/usr/bin/curl -L -o /home/vagrant/.ssh/id_rsa https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant
/usr/bin/curl -L -o /home/vagrant/.ssh/authorized_keys https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub
/bin/chown -R vagrant:vagrant /home/vagrant/.ssh
/bin/chmod 0400 /home/vagrant/.ssh/*





%end